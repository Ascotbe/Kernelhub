### CVE-2008-3464

#### Describe

afd.sys in the Ancillary Function Driver (AFD) component in Microsoft Windows XP SP2 and SP3 and Windows Server 2003 SP1 and SP2 does not properly validate input sent from user mode to the kernel, which allows local users to gain privileges via a crafted application, as demonstrated using crafted pointers and lengths that bypass intended ProbeForRead and ProbeForWrite restrictions, aka "AFD Kernel Overwrite Vulnerability."


#### ImpactVersion

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows Server 2003 |                  |         | SP1    |                    |
| Windows Server 2003 |                  |         | SP2    | &#10004; |
| Windows Server 2003 |                  |         | SP3    |                    |
| Windows Server 2003 |                  |         |        |                    |
| Windows Xp          |                  |         |        |                    |
| Windows Xp          |                  |         | SP2    |                    |
| Windows Xp          |                  |         | SP3    |                    |

#### Utilization

Only find Exe files, test systems Windows Server 2003 SP2 x86

![26](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2008-3464_win2003_x86.gif)

#### Analyze
- https://bbs.pediy.com/thread-74811.htm