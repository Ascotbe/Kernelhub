### CVE-2015-2370

#### Describe

The authentication implementation in the RPC subsystem in Microsoft Windows Server 2003 SP2 and R2 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1 does not prevent DCE/RPC connection reflection, which allows local users to gain privileges via a crafted application, aka "Windows RPC Elevation of Privilege Vulnerability."

#### ImpactVersion

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows Server 2003 |                  |         | SP2    |                    |
| Windows 2003 Server |                  | R2      | SP2    |                    |
| Windows 7           |                  |         | SP1    | &#10004; |
| Windows 8           |                  |         |        |                    |
| Windows 8.1         |                  |         |        | &#10004; |
| Windows Rt          |                  |         |        |                    |
| Windows Rt 8.1      |                  |         |        |                    |
| Windows Server 2008 |                  |         | SP2    |                    |
| Windows Server 2008 |                  | R2      | SP1    |                    |
| Windows Server 2012 |                  |         |        |                    |
| Windows Server 2012 |                  | R2      |        |                    |
| Windows Vista       |                  |         | SP2    |                    |

#### Utilization

CompilerEnvironment

- VS2019 Any CPU Release

X64 / x86 Windows 7 / 8.1 can be used in success, this vulnerability is to write files like any file directory, such as I am **c:\windows\system32\\**This directory does not have permission to write files, but I can use vulnerabilities to write files in this file.

```
#Write the desktop Test.txt file into the System32 folder
Trebuchet.exe c:\Users\ascotbe\Desktop\test.txt c:\Windows\System32\test1.txt
```

Demonstrate Machine Windows 7 SP1 x86

![2](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2015-2370_win7_x86.png)

#### Analyze
- http://bobao.360.cn/learning/detail/584.html
- https://blog.csdn.net/oShuangYue12/article/details/84677607