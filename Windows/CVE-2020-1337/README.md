## CVE-2020-1337

#### 描述

当Windows Print Spooler服务不正确时，存在特权漏洞的提升允许任意写入文件系统。可提升权限

#### 影响版本

| Product             | Version       | Update | Edition | Tested             |
| :------------------ | :------------ | ------ | ------- | ------------------ |
| Windows 7 | X86/x64 |  | SP1 |  |
| Windows 8.1 | X86/x64 |  |  |  |
| Windows 10 | X86/x64 |  |  |  |
| Windows 10          | X86/x64 | 1607 |         |          |
| Windows 10          | X86/x64/ARM64 | 1709 |         |                    |
| Windows 10 | X86/x64/ARM64 | 1803 | | |
| Windows 10 | X86/x64/ARM64 | 1809 | | |
| Windows 10          | X86/x64/ARM64 | 1903   |         |                    |
| Windows 10          | X86/x64/ARM64 | 1909   |         | &#10004; |
| Windows 10          | X86/x64/ARM64 | 2004   |         |                    |
| Windows Server 2008 | X86/x64 |  | SP2 | |
| Windows Server 2008 | x64 | R2 | SP1 | |
| Windows Server 2012 |  |  | | |
| Windows Server 2012 |  | R2 | | |
| Windows Server 2016 |               |        |         |                    |
| Windows Server 2019 | | | | |
| Windows Server      |               | 1903   |         |                    |
| Windows Server      |               | 1909   |         |                    |
| Windows Server      |               | 2004   |         |                    |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1337
```

#### 利用方式

编译环境

- VS2019（V142）X64 Release
- VS2019（V142）X64 Debug

第一种方式：

需要使用管理员权限把**phoneinfo.dll**文件放到`C:\Windows\System32`目录下，然后执行**WerTrigger.exe**文件进行提权

第二种方式：

sailay1996写了一个PS1脚本，但是有个限制是需要重启机器，首先是用PS1脚本执行，然后重启即可发现**phoneinfo.dll**已经在`C:\Windows\System32`目录下，接着只需要运行**WerTrigger.exe**文件即可提权

测试机器Windows 10 1909 x64如图所示

![CVE-2020-1337_windos_10_1909_x64](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2020-1337_windos_10_1909_x64.gif)

#### 分析文章
- https://bbs.pediy.com/thread-261557.htm

#### 脚本来源

- [sailay1996](https://github.com/sailay1996/cve-2020-1337-poc)

