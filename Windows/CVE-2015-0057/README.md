### CVE-2015-0057

#### 描述

内核模式驱动程序中的win32k.sys允许本地用户通过精心设计的应用程序获得特权。

#### 影响版本

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows 7           |                  |         | SP1    | &#10004; |
| Windows 8           |                  |         |        |                    |
| Windows 8.1         |                  |         |        |                    |
| Windows Rt          |                  |         |        |                    |
| Windows Rt 8.1      |                  |         |        |                    |
| Windows Server 2003 |                  |         | SP2    |                    |
| Windows Server 2008 |                  |         | SP2    |                    |
| Windows Server 2008 |                  | R2      | SP1    | &#10004; |
| Windows Server 2012 |                  |         |        |                    |
| Windows Server 2012 |                  | R2      |        |                    |
| Windows Vista       |                  |         | SP2    |                    |

#### 利用方式

目前有两个源码

1. **CVE-2015-0057_win8.1**文件夹下面的针对Windows8.1的源码，可行性未测试
2. [exploit-db](https://www.exploit-db.com/exploits/37098)下载下来的源码也未测试

测试使用的是网上找到的编译好的EXP`CVE-2015-0057_x86`和`CVE-2015-0057_x64`，可以对Windows7/2008利用成功，会添加用户账号`k8team$` 密码`K8TeAm520!@#`

对Windows 7 SP1 x86进行测试

![2](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2015-0057_win7_sp1_x86.gif)

#### 分析文章
- https://xz.aliyun.com/t/4549
- https://paper.seebug.org/1439/
- https://www.anquanke.com/post/id/163973
- https://blog.csdn.net/qq_35713009/article/details/102921859