### CVE-2015-1725

#### 描述

这个是一个位于 win32k.sys 的释放后重用漏洞。 漏洞的起因是没有为用户模式回调函数给窗口内核类型加锁， 该漏洞可以由 win32k.sys 中的 xxxSetClassLong 函数触发。 成功利用该漏洞将导致特权提升到“NT AUTHORITY/SYSTEM”。

#### 影响版本

| Product             | CPU Architecture | Version | Update | Tested |
| ------------------- | ---------------- | ------- | ------ | ------ |
| Windows 7           |                  |         | SP1    |        |
| Windows 8           |                  |         |        |        |
| Windows 8.1         |                  |         |        |        |
| Windows Rt          |                  |         |        |        |
| Windows Rt 8.1      |                  |         |        |        |
| Windows Server 2003 |                  |         | SP2    |        |
| Windows Server 2003 |                  | R2      | SP2    |        |
| Windows Server 2008 |                  |         | SP2    |        |
| Windows Server 2008 |                  | R2      | SP1    |        |
| Windows Server 2012 |                  |         |        |        |
| Windows Server 2012 |                  | R2      |        |        |
| Windows Vista       |                  |         | SP2    |        |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2015-1725
```

#### 利用方式

该漏洞并未进行测试，根目录留存着网络收集**[CVE编号].zip**的EXP或者POC，代码状态未知

#### 项目来源

- [Rootkitsmm](https://github.com/Rootkitsmm/MS15-061)

#### 分析文章
- https://github.com/LibreCrops/translation-zh_CN/blob/master/source/ms-15-061.rst
- https://translation-zh-cn.readthedocs.io/zh_CN/latest/ms-15-061.html