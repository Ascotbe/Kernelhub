### CVE-2012-0217

#### Describe

The x86-64 kernel system-call functionality in Xen 4.1.2 and earlier, as used in Citrix XenServer 6.0.2 and earlier and other products; Oracle Solaris 11 and earlier; illumos before r13724; Joyent SmartOS before 20120614T184600Z; FreeBSD before 9.0-RELEASE-p3; NetBSD 6.0 Beta and earlier; Microsoft Windows Server 2008 R2 and R2 SP1 and Windows 7 Gold and SP1; and possibly other operating systems, when running on an Intel processor, incorrectly uses the sysret path in cases where a certain address is not a canonical address, which allows local users to gain privileges via a crafted application. NOTE: because this issue is due to incorrect use of the Intel specification, it should have been split into separate identifiers; however, there was some value in preserving the original mapping of the multi-codebase coordinated-disclosure effort to a single identifier.


#### ImpactVersion

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows 7           |                  |         | SP1    |                    |
| Windows 7           |                  |         |        |                    |
| Windows Server 2003 |                  |         | SP2    |                    |
| Windows Server 2008 |                  | R2      |        |                    |
| Windows Server 2008 |                  | R2      | SP1    | &#10004; |
| Windows Xp          |                  |         | SP3    |                    |

#### Utilization

CompilerEnvironment

- VS2019（V100）X64 Release

Test system Windows Server 2008 R2 SP1 x64

![20](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2012-0217_win2008_x64.gif)

