### CVE-2011-1249

#### Describe

The Ancillary Function Driver (AFD) in afd.sys in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 does not properly validate user-mode input, which allows local users to gain privileges via a crafted application, aka "Ancillary Function Driver Elevation of Privilege Vulnerability."

#### ImpactVersion

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows 7           |                  |         | SP1    | &#10004; |
| Windows Server 2003 |                  |         | SP2    | &#10004; |
| Windows Server 2008 |                  |         | SP2    |                    |
| Windows Server 2008 |                  |         |        |                    |
| Windows Server 2008 |                  | R2      |        |                    |
| Windows Server 2008 |                  | R2      | SP1    |                    |
| Windows Vista       |                  |         | SP1    |                    |
| Windows Vista       |                  |         | SP2    |                    |
| Windows Xp          |                  |         | SP2    |                    |
| Windows Xp          |                  |         | SP3    |                    |

#### Utilization

Compilation file

```
i686-w64-mingw32-gcc CVE-2011-1249.c -o CVE-2011-1249.exe -lws2_32
```

Test system Windows Server 2003 SP2 x86 and Windows 7 SP1 x86 Can use

![23](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2011-1249_win2003_x86.gif)

#### Analyze
- https://github.com/Madusanka99/OHTS/blob/master/IT16075504%20-OHTS%20Report.pdf