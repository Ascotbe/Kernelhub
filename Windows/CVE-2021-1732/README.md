### CVE-2021-1732

#### 描述

Win32k 权限提升漏洞

#### 影响版本

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows 10          | x64/x86/ARM64    | 20H2    |        |                    |
| Windows 10          | x64/x86/ARM64    | 2004    |        |                    |
| Windows 10          | x64/x86/ARM64    | 1909    |        | &#10004; |
| Windows 10          | x64/x86/ARM64    | 1809    |        | &#10004; |
| Windows 10          | x64/x86/ARM64    | 1803    |        |                    |
| Windows 10          | x64/x86/ARM64    |         |        |                    |
| Windows Server 2019 |                  |         |        |                    |
| Windows Server      |                  | 1909    |        |                    |
| Windows Server      |                  | 2004    |        |                    |
| Windows Server      |                  | 20H2    |        |                    |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-1732
```

#### 利用方式

编译环境

- VS2019（V120）X64 Debug

这里测试机器是Windows 10 1909  x64，上GIF图

![1](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2021-1732_windows_10_1909_x64.gif)

#### 分析文章
- https://www.freebuf.com/vuls/270295.html
- https://021w.github.io/2021/03/12/CVE-2021-1732Win32kfull-sys%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/
- https://laptrinhx.com/shen-ru-pou-xicve-2021-1732lou-dong-1153028117/
- https://bbs.pediy.com/thread-266362.htm
- https://www.secrss.com/articles/29758

#### 代码来源

- [KaLendsi](https://github.com/KaLendsi/CVE-2021-1732-Exploit)