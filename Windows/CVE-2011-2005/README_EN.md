### CVE-2011-2005

#### Describe

afd.sys in the Ancillary Function Driver in Microsoft Windows XP SP2 and SP3 and Server 2003 SP2 does not properly validate user-mode input passed to kernel mode, which allows local users to gain privileges via a crafted application, aka "Ancillary Function Driver Elevation of Privilege Vulnerability."

#### ImpactVersion

| Product             | CPU Architecture | Version | Update | Tested             |
| ------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows Server 2003 |                  |         | SP2    | &#10004; |
| Windows Xp          |                  |         | SP2    |                    |
| Windows Xp          |                  |         | SP3    |                    |

#### Utilization

Test system Windows Server 2003 SP2 x86

![21](https://raw.github.com/Ascotbe/Image/master/Kernelhub/CVE-2011-2005_win2003_x86.gif)

MSF uses it directly to use this

```
use exploit/windows/local/ms11_080_afdjoinleaf
```

#### Analyze
- http://qq53.github.io/1500623869.html